<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>Profile and Courses</title>
    <link rel="stylesheet" href="edit.css" />
    <style>
      table {
        border-collapse: collapse;
        margin: auto;
      }
      th,
      td {
        border: 1px solid black;
        padding: 15px;
        text-align: center;
      }
      #profile-info {
        text-align: center;
        margin: auto;
        max-width: 400px;
      }
    </style>
  </head>

  <body>
    <header>
      <div class="logo">
        <img src="./logo.jpg" alt="Organization Logo" />
      </div>
      <nav>
        <ul>
          <li><a href="./profile.html">Profile</a></li>
          <li><a href="./course.html">Courses</a></li>
        </ul>
      </nav>
    </header>

    <main>
      <section class="tab-content" id="profile">
        <h2>Profile</h2>
        <div id="profile-info">
          <p><strong>Name:</strong> Harry</p>
          <p><strong>SID:</strong> 123456789</p>
          <p><strong>Major:</strong> Computer Science</p>
          <p><strong>Age:</strong> 22</p>
          <p><strong>Gender:</strong> Male</p>
          <p><strong>Advisor:</strong> Harry</p>
        </div>
        <table id="coursesTable">
          <tbody>
            <tr>
              <th>Course Name</th>
              <th>Course Hours</th>
              <th>Course ID</th>
              <th>Professor Name</th>
            </tr>
          </tbody>
        </table>
      </section>
    </main>
    <script>
      function fetchProfileAndCourses() {
        fetch("/profile")
          .then((response) => response.json())
          .then((data) => {
            const profileInfoDiv = document.getElementById("profile-info");
            profileInfoDiv.innerHTML = `
            <p><strong>Name:</strong> ${data.profile.stu_name}</p>
            <p><strong>SID:</strong> ${data.profile.sid}</p>
            <p><strong>Major:</strong> ${data.profile.major}</p>
            <p><strong>Age:</strong> ${data.profile.age}</p>
            <p><strong>Gender:</strong> ${data.profile.gender}</p>
          `;

            // Update course details
            const courses = data.courses;
            const table = document
              .getElementById("coursesTable")
              .getElementsByTagName("tbody")[0];

            // Clear any existing rows (except headers)
            table.innerHTML =
              "<tr><th>Course Name</th><th>Course Hours</th><th>Course ID</th><th>Professor Name</th></tr>";

            // Add rows for each course
            courses.forEach((course) => {
              const row = table.insertRow();
              row.insertCell(0).innerText = course.course_Name;
              row.insertCell(1).innerText = course.course_Hours;
              row.insertCell(2).innerText = course.course_ID;
              row.insertCell(3).innerText = course.professor_Name;
            });
          })
          .catch((error) => {
            console.error("Error fetching profile and courses:", error);
          });
      }

      // Call the function to fetch profile and course details on page load
      window.onload = fetchProfileAndCourses;
    </script>
  </body>
</html>
